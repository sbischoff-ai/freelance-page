trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

steps:
- script: |
    az login --service-principal --allow-no-subscriptions -u d93b866b-54e7-4a05-80de-4ef11fe019b2 -p $(AZURE_SECRET) --tenant 6ef5bd57-30e3-40c4-a543-a5f1a391e645
    az acr login --name freelancecontainer
  displayName: login to azure and container registry

- script: |
    docker build -t freelancecontainer.azurecr.io/freelance-page:test
    docker push freelancecontainer.azurecr.io/freelance-page:test
  displayName: 'build and push docker container'

# The page is redeployed automatically via webhook
